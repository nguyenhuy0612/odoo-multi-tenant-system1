# Dynamic upstream configuration for Odoo workers
# This file contains the actual worker configurations

upstream odoo_workers_dynamic {
    least_conn;
    server odoo_worker1:8069 max_fails=2 fail_timeout=10s;
    server odoo_worker2:8069 max_fails=2 fail_timeout=10s;
    keepalive 8;
}

# Additional upstream for asset serving
upstream odoo_assets {
    least_conn;
    server odoo_worker1:8069 max_fails=2 fail_timeout=10s;
    server odoo_worker2:8069 max_fails=2 fail_timeout=10s;
    keepalive 8;
}

# Sticky sessions upstream for login consistency  
upstream odoo_workers_sticky {
    ip_hash;
    server odoo_worker1:8069 max_fails=2 fail_timeout=10s;
    server odoo_worker2:8069 max_fails=2 fail_timeout=10s;
    keepalive 8;
}

